### 目的

描述给ChartGPT关于本项目的需求和功能， ChartGPT（VS Code里面的Codex插件）根据本文的要求用TS（type script）开发完成本项目

### 项目（或者叫做本项目）

用TS编写一个多维表格的边栏插件，插件的主要功能是：

1. 根据SOL里面的inner pack， master qty和产品的长宽高，自动计算中箱和外箱的尺寸，以及毛重，净重。
2. 根据要求自动生成视图（比如一个只看价格的视图），用于给客户报价的视图
3. 单位转换
4. 自动生成成本预分析
5. 其他

### SOL

一张多维表格的名字， 用于管理产品开发的进度和信息的存储，里面有很多字段，用于存储产品的信息。

### 项目的名字

SOL Manager

### SOL里面的列（字段）的名字（或者叫字段的标题）

Item Height (inch) （后面会写成item height，或者产品高度，或者产品的高, 等等...）

Item Width (inch)（后面会写成item width，或者产品宽度，或者产品的宽,等等...）

Item Depth (inch)（后面会写成item depth，或者产品深度，或者产品的深,等等...）

Item Weight ( g )（产品的重量）

Inner Width (inch)（中箱/中盒的宽度）

Inner Depth (inch)（中箱/中盒的深度）

Inner Height (inch)（中箱/中盒的高度）

Inner Weight (lbs)（中箱/中盒的毛重）

Master Qty （外箱的装箱的数量，这是一个非常重要的字段，后面又会叫做case pack，或者装箱量）

Inner Qty（中箱/中盒的装箱数量，后面又会叫做 inner pack，或者中盒装箱量）

Inner per Master(外箱中有几个中盒 = Master Qty / Inner Qty)

Master Height (inch)（外箱的高度）

Master Width (inch)（外箱的宽度）

Master Depth (inch)（外箱的深度）

N.W. (kg)（外箱的净重）

### 功能1: 计算外箱的高宽深和重量

1. 计算的input：
   1. 产品的宽， 高，深， 还有产品的重量（从以上的字段读取），所以这一部分是手动在多维表格输入的。
   2. 手动输入（在插件的界面中， 也就是index.html中）一个数字， 他的名字叫做inner buffer和master buffer（两个文本框来输入），并在在文本框的后面跟着一个下拉列表，选项分别是1. 英寸，2. 厘米，（分别告诉插件我的buffer输入的单位是cm还是英寸）
   3. 手动指定中盒是常规的盒子还是塑料袋（所以需要在index.html中有一个下拉列表(label叫做 Inner Material)来选择，选项分别是1. Box 2. Poly Bag）
   4. 手动指定哪些记录需要计算. 或者选择所有的记录, 或者选择一部分记录, 所以在Index.html中需要一个选择框, label是“全选”, 如果是选中(默认就是选中的), 那么则计算所有的记录, 这个“全选”默认是没有选中的. 如果, 有记录被选中, 那么则只计算选中的记录. 如果没有任何一条记录被选中, 那么计算所有的记录. 在“全选”没有被选中的情况下,  并且用户也没有选择任何一条记录. 那么则要跳出对话框警告是否真的要计算所有的记录, 在用户点击确认了以后再进行全部字段的计算, 如果在这中情况下“全选”选中的, 那么则不用跳出对话框, 直接进行计算. 
2. 计算的output：
   1. 中盒的宽，高，深，毛重（如 Inner Qty 为 0 或空，应清空这些字段）
   2. 外箱的宽,高,深, 净重
   3. 计算完成以后, 填写对应的字段当中去. 
3. 计算的方法:
   1. 先找到inner qty这个字段的数字
      1. 如果该字段的数字为空或者0，那么不需要计算inner的,宽,高,深和毛重, 并且inner的宽,高,深和毛重单元格里面的记录应该需要被清空(如果有的话)
      2. Inner Qty 必须是整数，出现小数或非数值时跳过此记录并记录提示
      2. 如果该字段是有数字的, 则可开始计算:
         1. Inner Qty是一个整数, 把这个整数拆成三个整数相乘, 假如这个数字是6, 那么他可以拆解成如下的任何一种:
            1. 1 x 6 x 1
            2. 1 x 1 x 6
            3. 6 x 1 x 1
            4. 2 x 3 x 1
            5. ........
         2. 其中第一个数字是宽度方向, 第二个数字是深度方向, 第三个数字是高度方向, 这就是意味着产品在inner中的排列是一个立方体, 宽高深各放置若干个, 这些“若干个”乘起来就是inner Qty.
         3. 中盒尺寸的计算的方法: 宽度方向 * item width + buffer,(高度和深度以此类推).
            1. 当中盒的material是poly bag的时候, 那么buffer强制用0来计算. 不管inner buffer填写的是什么数字, 都用0来计算. 
         4. 中盒的毛重的计算方法: (inner pack x item weight (g)+100) x 0.00220462(g转换成lb), 如果用户选择的inner material是Poly Bag的话, 那么这里的100就是0, 因为poly bag假设没有重量.
         5. Cube feet = 中盒 高 x 宽 x 深, 在历遍第1点中的所有情况以后, 选择cube feet为最小的情况下的尺寸和重量. 所以这个就是选择数据的标准 Cube Feet = Minium
   2. 再找到 Master Qty 这个字段的数字
      1. 如果 master qty 字段是 0 或空白, 那么需要对话框提示, Case pack is zero, pls input the master qty as case pack!. 并且跳过该条记录
      2. Master Qty 必须是整数，出现小数或非数值时跳过并记录提示
      3. 若 master qty 有效，则根据是否存在中盒选择算法：
         1. 中盒存在时，沿用 inner 的排列结果并使用 master buffer 计算外箱尺寸。
         2. 无中盒时直接以产品尺寸配合 master buffer 计算外箱尺寸。
      4. 数据的选择与 inner 逻辑一致（以体积最小为标准）。
      5. 净重：产品重量 × Master Qty ÷ 1000（单位：kg）。
4. 跳过空白行
   1. 在SOL中有很多空白行, 为了快速计算, 如果发现有空白行(就是空白记录), 则不应该对他有任何计算, 应该即可跳过, 稍微提示一下“空白行,没有计算”就可以了. 
   2. 空白行的判断:
      1. 产品的高, 宽, 深没有数据

### 其他要求

- 插件日志中使用 `ITEM#` 字段的值作为记录标识（若无值则回退至 record id）。
- 计算前，如“全选”复选框未勾选且无记录被用户选中，应弹窗确认是否处理所有记录；用户确认后再继续。
